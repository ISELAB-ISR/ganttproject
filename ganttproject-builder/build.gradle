apply plugin: 'java'
def installDir = file("dist-bin").getAbsolutePath()
subprojects {
  def installDir = rootProject.installDir
}
def version = '2.6-rc1'

task copyEclipsito(type: Jar) {
  from zipTree(project(":..:ganttproject").projectDir.getAbsolutePath() + "/lib/core/eclipsito.jar")
  from "ganttproject-eclipsito-config.xml"
  destinationDir = file(installDir)
  archiveName = "eclipsito.jar"
}

task copyLaunchers(type:Copy) {
  from(".")
  into(installDir)
  include "ganttproject"
  include "ganttproject.command"
  include "README-install.txt"
  include "LICENSE"
  include "ganttproject.bat"
  include "ganttproject.exe"
  include "ganttproject_16.ico"
  include "ganttproject_32_2.ico"
  include "GanttProject.app/**"
  include "HouseBuildingSample.gan"
}


assemble.dependsOn copyLaunchers
assemble.dependsOn copyEclipsito

task dist << {
  delete {
    'ganttproject-' + version
  }
  def dist_name = 'ganttproject-' + version
  file(installDir).renameTo(dist_name)
  task zip(type: Zip) {
    from dist_name
  }
}

task zip << {
}
dist.dependsOn assemble

task clean_dist << {
}

clean_dist.dependsOn clean
clean_dist.dependsOn dist
